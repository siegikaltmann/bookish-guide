<nav class="card toc" aria-label="Inhaltsverzeichnis" style="margin-bottom:16px;">
  <h2 style="margin:0 0 8px;">Inhaltsverzeichnis</h2>
  <ol class="toc-list" style="margin:0;padding-left:18px;"></ol>
</nav>

<script>
(function(){
  // Sammle H2/H3-Überschriften der Seite
  const headings = Array.from(document.querySelectorAll('main h2, main h3'));
  if (!headings.length) return;

  // Slug-Funktion für IDs
  const slug = s => s.toLowerCase()
    .replace(/<[^>]*>/g,'')
    .replace(/[^\wäöüß\- ]+/g,'')
    .replace(/\s+/g,'-')
    .replace(/-+/g,'-')
    .replace(/^-|-$/g,'');

  // IDs setzen, falls fehlen
  headings.forEach(h => {
    if (!h.id) h.id = slug(h.textContent);
  });

  // Liste aufbauen (H2 = Ebene 1, H3 = eingerückt)
  const list = document.currentScript.previousElementSibling.querySelector('.toc-list');
  let currentOl = list;
  let lastLevel = 2;

  headings.forEach(h => {
    const level = +h.tagName.substring(1); // 2 oder 3
    if (level > lastLevel) {
      const ol = document.createElement('ol');
      ol.style.margin = '6px 0 0 14px';
      currentOl.lastElementChild?.appendChild(ol);
      currentOl = ol;
    } else if (level < lastLevel) {
      currentOl = currentOl.parentElement.closest('ol') || list;
    }
    const li = document.createElement('li');
    li.style.margin = '4px 0';
    const a = document.createElement('a');
    a.href = '#' + h.id;
    a.textContent = h.textContent;
    li.appendChild(a);
    currentOl.appendChild(li);
    lastLevel = level;
  });
})();
</script>

<style>
.toc a { text-decoration: none; }
.toc a:hover { text-decoration: underline; }
</style>
